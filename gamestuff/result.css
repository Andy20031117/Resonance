/* ========== 調色盤（藍紫×科技×金色點綴） ========== */
:root{
  --bg-deep:#0D0B15;
  --vio-1:#5B7CFF;    /* 藍紫 */
  --vio-2:#9B5BFF;    /* 紫羅蘭 */
  --cyan:#8EE7FF;     /* 電光青 */
  --gold:#FFD447;     /* 復古金（點綴）*/
  --ink:#EDEAF7;
  --muted:#B9B2CF;
  --glass:rgba(255,255,255,.06);

  /* 尺寸（更小，留白更大） */
  --card-w: clamp(180px, 18vw, 230px);
  --card-h: clamp(255px, 26vw, 320px);
  --ring-radius-desktop: 340px;
  --ring-radius-mobile: 240px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; background:var(--bg-deep); color:var(--ink); font-family:"Noto Sans TC",system-ui,-apple-system,"PingFang TC","Microsoft JhengHei",sans-serif; }
body{ margin:0; overflow:hidden; }

/* === 讓背景圖直接出現（不靠 JS），並解決層級 === */
.bg{ position:fixed; inset:0; z-index:0; }            /* 由 -1 改為 0 */
.scene{ position:relative; z-index:1; }               /* 讓內容在背景之上 */


/* ==== 背景主視覺：endBG.png ==== */
.bg__image{
  position:absolute; inset:0;
  background: url("endBG.png") center/cover no-repeat; /* 直接指定主視覺 */
  filter:none; 
}

/* 其餘背景層保持在 .bg__image 之上（z-index 默認即可） */

.bg__nebula{
  position:absolute; inset:-10%;
  background:
    radial-gradient(60% 40% at 20% 20%, #3C2C71 0%, #1C1538 48%, transparent 60%),
    radial-gradient(45% 35% at 80% 30%, #2A2E77 0%, #14112F 55%, transparent 70%),
    radial-gradient(55% 45% at 50% 80%, #2C1F57 0%, #120F24 55%, transparent 70%),
    linear-gradient(180deg, #0B0A13 0%, #0C0A17 100%);
  filter: saturate(1.1) blur(0.4px);
  transform: scale(1.1);
}

.bg__stars{
  position:absolute; inset:0;
  background:
    radial-gradient(2px 2px at 20% 30%, #fff6 40%, transparent 42%),
    radial-gradient(1px 1px at 60% 70%, #fff4 40%, transparent 42%),
    radial-gradient(1.5px 1.5px at 80% 20%, #fff5 40%, transparent 42%),
    radial-gradient(1.2px 1.2px at 35% 80%, #fff5 40%, transparent 42%),
    radial-gradient(1px 1px at 10% 60%, #fff3 40%, transparent 42%);
  animation: twinkle 8s linear infinite; opacity:.55; pointer-events:none;
}
@keyframes twinkle{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-1.5vh)} }

.bg__constellations{
  position:absolute; inset:-5%;
  background:
    repeating-linear-gradient(0deg, #8EE7FF0A 0 1px, transparent 1px 22px),
    repeating-linear-gradient(90deg, #8EE7FF0A 0 1px, transparent 1px 22px),
    radial-gradient(closest-side, #8EE7FF0A 25%, transparent 26%) 30% 40%/280px 280px no-repeat,
    radial-gradient(closest-side, #8EE7FF0A 25%, transparent 26%) 70% 65%/220px 220px no-repeat;
  mix-blend-mode: screen; opacity:.2; filter: blur(.2px);
  animation: spinConst 60s linear infinite;
}
@keyframes spinConst{ to{ transform: rotate(1turn) } }

.bg__hourglass{
  position:absolute; inset:0; pointer-events:none; opacity:.08;
  background:
    radial-gradient(60% 60% at 50% 50%, #FFD44720 0%, transparent 60%),
    conic-gradient(from 0deg at 50% 50%, transparent 0 20deg, #FFD4471a 20deg 40deg, transparent 40deg 60deg, #FFD44714 60deg 80deg, transparent 80deg 100deg, #FFD44710 100deg 120deg, transparent 120deg 360deg);
  mix-blend-mode: screen;
}

/* ========== 版面 ========== */
.scene{
  height:100dvh; display:grid;
  grid-template-rows:auto 1fr auto;
  row-gap:.8rem;
  padding:max(12px, env(safe-area-inset-top)) max(12px, env(safe-area-inset-right)) max(12px, env(safe-area-inset-bottom)) max(12px, env(safe-area-inset-left));
}
.header{text-align:center; user-select:none;}
.title{
  margin:.2rem 0 0; font-size:clamp(22px,3vw,28px); letter-spacing:.14em;
  color:transparent; position:relative; display:inline-block;
}
.title span{
  background: linear-gradient(90deg, var(--cyan), var(--vio-1), var(--vio-2));
  -webkit-background-clip:text; background-clip:text; color:transparent;
  text-shadow: 0 0 24px #9B5BFF22;
}
.title::after{
  /* 星雲掃光 */
  content:""; position:absolute; left:-10%; top:0; height:100%; width:30%;
  background: linear-gradient(120deg, transparent 0%, #FFFFFF33 50%, transparent 100%);
  filter: blur(8px); transform: skewX(-12deg); animation: headlineSweep 4.8s ease-in-out infinite;
}
@keyframes headlineSweep{
  0%,15%{ transform:translateX(0) skewX(-12deg) }
  40%{ transform:translateX(140%) skewX(-12deg) }
  100%{ transform:translateX(140%) skewX(-12deg) }
}
.subtitle{ margin:.25rem 0 0; color:var(--muted); font-size:13px; }

/* 卡片整區下移 */
.ring-wrap{
  position:relative;
  height:min(64vh,680px);
  perspective:1400px; -webkit-perspective:1400px;
  overflow:visible;
  margin-top: clamp(14px, 5vh, 56px);
}
.ring{
  position:absolute; inset:0; margin:auto;
  width:min(90vw,980px); height:100%;
  transform-style:preserve-3d; will-change:transform;
  touch-action:none;
}

/* 邊緣熱區（懸停自動步進，點擊單步） */
.hotzone{
  position:absolute; top:0; bottom:0;
  width: min(20vw, 220px);
  pointer-events:auto; cursor:pointer; background: transparent;
}
.hotzone--left { left:0; } .hotzone--right{ right:0; }
.ring-wrap:hover .hotzone--left::after,
.ring-wrap:hover .hotzone--right::after{ opacity:.28; }
.hotzone::after{
  content:""; position:absolute; top:50%; transform:translateY(-50%);
  width:26px; height:26px; opacity:0; transition:opacity .2s ease;
  border-top:2px solid #fff8; border-right:2px solid #fff8;
  filter: drop-shadow(0 0 8px #000);
}
.hotzone--left::after { left:14px; transform:translateY(-50%) rotate(-135deg); }
.hotzone--right::after{ right:14px; transform:translateY(-50%) rotate(45deg); }

/* ========== 卡片 ========== */
.card{
  position:absolute; left:50%; top:50%;
  width:var(--card-w); height:var(--card-h);
  transform-style:preserve-3d;
  transition: filter .28s ease, opacity .28s ease, visibility .28s ease, transform .5s ease;
}
.card.is-hidden{ opacity:0; visibility:hidden; pointer-events:none; }

/* 翻轉（每張卡都可翻） */
.card .card-inner{
  position:absolute; inset:0; transform-style:preserve-3d;
  transition: transform .5s cubic-bezier(.2,.6,.2,1), box-shadow .25s ease;
}
.card.flipped .card-inner{ transform: rotateY(180deg); }

.card-face{
  position:absolute; inset:0; backface-visibility:hidden;
  background:linear-gradient(180deg,#1a171f,#0f0c16);
  border:1px solid #7F6AF266; border-radius:18px;
  box-shadow: inset 0 0 0 1px #ffffff10, 0 18px 50px -20px rgba(0,0,0,.6);
  overflow:hidden;
}

/* 背面：統一塔羅牌樣式（藍紫版） */
.card-back{
  transform:rotateY(180deg);
  background:
    radial-gradient(1px 1px at 20% 30%, #8EE7FF55 50%, transparent 52%),
    radial-gradient(1px 1px at 70% 40%, #8EE7FF44 50%, transparent 52%),
    radial-gradient(1px 1px at 38% 75%, #8EE7FF44 50%, transparent 52%),
    radial-gradient(closest-side, #9B5BFF18 30%, transparent 32%),
    radial-gradient(closest-side, #5B7CFF18 55%, transparent 57%),
    repeating-linear-gradient(0deg, #8EE7FF10 0 1px, transparent 1px 16px),
    repeating-linear-gradient(90deg, #8EE7FF10 0 1px, transparent 1px 16px),
    linear-gradient(180deg,#17142A,#100E1C);
   transform: rotateY(180deg);
  /* ✅ 直接使用你提供的牌背圖 */
  background: url("talocard.png") center/cover no-repeat;
  /* 若想保留一點質感疊層，可加上淡淡的色階： */
  /* background:
     url("talocard.png") center/cover no-repeat,
     radial-gradient(60% 60% at 50% 50%, #ffffff05, transparent 60%); */
}

/* 其餘樣式維持原樣（邊框掃光、圓角等） */  

/* 描邊與掃光（藍紫色相） */
.card-face::before{
  content:""; position:absolute; inset:0; border-radius:18px; padding:1.1px;
  background:linear-gradient(135deg,#9B5BFFaa,#5B7CFFaa);
  -webkit-mask-composite:xor; mask-composite:exclude; opacity:.65; pointer-events:none;
}
.card-face::after{
  content:""; position:absolute; inset:-45%;
  background: conic-gradient(from 0deg, transparent 0 86%, #8EE7FF2a 87% 92%, transparent 93% 100%);
  animation:sweep 7s linear infinite; pointer-events:none; opacity:.2;
}
@keyframes sweep{ to{ transform:rotate(1turn) } }

/* 中央聚焦（保留清晰） */
.card.is-center .card-inner{
  transform: translateZ(6px);
  box-shadow: 0 16px 44px -18px rgba(91,124,255,.24), 0 0 0 1px #8EE7FF33 inset;
}
.card.is-center { filter:none; opacity:1; }
.card:not(.is-center){ filter:none; opacity:1; }

/* 內容排版（提高可讀性） */
.card__head{ display:flex; align-items:center; gap:.7rem; padding:12px 14px 8px; border-bottom:1px dashed #FFFFFF14; }
.badge{ width:34px; height:34px; border-radius:50%;
  background: radial-gradient(circle at 30% 30%, var(--vio-1), var(--vio-2));
  box-shadow: inset 0 0 8px #0008, 0 4px 12px #0006;
  display:grid; place-items:center; font-weight:800; color:#0C0A14;
}
.card__title{
  font-weight:800; letter-spacing:.08em; color:var(--ink);
  text-shadow: 0 0 10px #5B7CFF33;
}
.card__body{ padding:10px 14px 14px; line-height:1.66; color:var(--ink); }
.kpi{ display:grid; gap:8px; }
.kpi__row{ display:flex; align-items:baseline; justify-content:space-between; gap:10px; }
.kpi__label{ color:var(--muted); font-size:12px; letter-spacing:.02em; }
.kpi__value{ font-weight:900; font-size:clamp(18px, 2.6vw, 22px); letter-spacing:.01em; }

/* 完成度圓環（改藍紫） */
.ring-progress{
  --p:0; width:96px; height:96px;
  background:
    radial-gradient(closest-side, #0f0c16 78%, transparent 80%),
    conic-gradient(var(--vio-1) calc(var(--p) * 1%), #2A2355 0);
  border-radius:50%;
  box-shadow:0 8px 24px #0007, inset 0 0 0 1px #fff1;
  display:grid; place-items:center; margin:6px auto 0;
}
.ring-progress span{ font-weight:900; color:var(--cyan); font-size:14px; }

/* 榜單 */
.list{ margin:6px 0 0; padding:0; list-style:none; border-top:1px dashed #FFFFFF14; }
.list li{ display:grid; grid-template-columns:1.5ch 1fr auto; gap:8px; padding:6px 0; border-bottom:1px dashed #FFFFFF0f; font-variant-numeric:tabular-nums; }
.list li strong{ color:var(--ink); }
.list li small{ color:var(--muted); }

/* CTA 按鈕（虹彩掃描 + 微光外暈） */
.cta-bar{ display:grid; grid-auto-flow:column; gap:12px; align-items:center; justify-content:center; padding-bottom:8px; }
.btn{
  --pad:10px 16px;
  padding:var(--pad); border-radius:999px; font-weight:800; letter-spacing:.08em;
  border:1px solid #FFFFFF22; background:var(--glass); color:var(--ink);
  backdrop-filter: blur(6px); cursor:pointer; position:relative; overflow:hidden;
  transition: transform .18s ease, box-shadow .18s ease, background .2s ease;
}
.btn::after{
  content:""; position:absolute; inset:0; opacity:.0; pointer-events:none;
  background: linear-gradient(90deg, transparent, #FFFFFF22, transparent);
  transform: translateX(-120%); transition: transform .5s ease, opacity .3s ease;
}
.btn:hover::after{ transform: translateX(120%); opacity:.8; }
.btn:hover{ transform:translateY(-1px); box-shadow:0 10px 24px #0007; }
.btn:active{ transform:translateY(0); box-shadow:none; }
.btn--primary{
  background: linear-gradient(135deg, var(--vio-1), var(--vio-2));
  color:#0C0A14; border-color:#8EE7FF55; box-shadow: 0 0 24px #5B7CFF33;
}
.btn--ghost{ background:linear-gradient(180deg,#141127,#0f0c16); }
.btn--link{ background:transparent; border-color:transparent; color:var(--muted); }

/* 點擊火花 */
#spark-layer{ position:fixed; inset:0; pointer-events:none; z-index:5; }
.spark{
  position:absolute; width:4px; height:4px; border-radius:50%;
  background: radial-gradient(circle, #fff, #8EE7FF 60%, transparent 70%);
  animation: sparkPop .5s ease-out forwards;
  box-shadow: 0 0 10px #8EE7FF, 0 0 20px #5B7CFF66;
}
@keyframes sparkPop{
  0%{ transform: scale(0); opacity:1 }
  70%{ transform: scale(1); opacity:1 }
  100%{ transform: scale(1.8); opacity:0 }
}

/* 截圖閃光 */
.flash{ position:fixed; inset:0; pointer-events:none; background:white; opacity:0; transition:opacity .35s ease; z-index:999; }
.flash.show{ opacity:.2; }

@media (max-width: 920px){
  .ring{ width:100vw; }
  .kpi__value{ font-size:clamp(16px, 3.6vw, 20px); }
}


/* === 暫時關閉所有前景特效層，避免霧霧的 === */
.bg__nebula,
.bg__constellations,
.bg__hourglass,
.bg__stars{ display:none !important; }

/* === 文字銳利度（避免看起來髒髒的） === */
body{ -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }

/* === 卡面：拿掉會蓋住細節的掃光疊層（尤其是背面） === */
.card-face::after{ display:none !important; }          /* 全部卡面移除掃光覆蓋 */
.card-back::before{ display:none !important; }         /* 背面也不畫描邊覆蓋（只留你圖） */

/* === 卡牌背面：只顯示 talocard.png，其他都不要 === */
.card-back{
  transform: rotateY(180deg);
  background: url("talocard.png") center/cover no-repeat;
}

/* 以防你還沒改 JS：把背面的任何內文/標題都隱藏 */
.card-back .card__head,
.card-back .card__body{ display:none !important; }

/* 背景層級：背景在 0，內容在 1，避免被前景特效蓋住 */
.bg{ position:fixed; inset:0; z-index:0; }
.scene{ position:relative; z-index:1; }

/* ✅ 背景主視覺：縮小一點但仍滿版
   技巧：外層往外擴 (inset:-9%)，內層縮放 (scale:0.92) 看起來更「遠」但不留黑邊 */
:root{ --bg-zoom: 0.85; } /* 想再小：0.88~0.95 自行調整 */
.bg__image{
  position:absolute; inset:-9%;
  background: url("endBG.png") center/cover no-repeat;
  transform: scale(var(--bg-zoom));
  transform-origin: center;
  filter:none;
}

/* 暫關前景特效，避免朦朧感 */
.bg__nebula,
.bg__constellations,
.bg__hourglass,
.bg__stars{ display:none !important; }

/* 文字銳利 */
body{ -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }

/* 移除卡面掃光覆蓋，避免降低銳利度 */
.card-face::after,
.card-face::before{ display:none !important; }

/* ✅ 牌背只貼圖、且鋪滿卡片框（不留邊、不顯示任何內文） */
.card-back{
  transform: rotateY(180deg);
  background: url("talocard.png") center/100% 100% no-repeat; /* 無裁切、完整鋪滿 */
  border:none; box-shadow:none;
}
.card-back .card__head,
.card-back .card__body{ display:none !important; }


/* ============================================================
   FX PACK — 背景/卡片/文字（append-only）
   不改動原本規則；所有特效用新增 class/偽元素/CSS 變數
============================================================ */

/* ---------- 背景：雙層星野漂移 ---------- */
.fx-stars{ position: absolute; inset:-5%; pointer-events:none; z-index:0; }
.fx-stars--far{
  opacity:.35;
  background:
    radial-gradient(1.2px 1.2px at 10% 20%, #fff8 40%, transparent 42%),
    radial-gradient(1.2px 1.2px at 40% 70%, #fff6 40%, transparent 42%),
    radial-gradient(1px 1px at 85% 35%, #fff6 40%, transparent 42%),
    radial-gradient(1px 1px at 25% 85%, #fff5 40%, transparent 42%);
  animation: starDriftFar 60s linear infinite;
}
.fx-stars--near{
  opacity:.55;
  background:
    radial-gradient(1.6px 1.6px at 20% 30%, #fff9 40%, transparent 42%),
    radial-gradient(1.6px 1.6px at 60% 65%, #fff8 40%, transparent 42%),
    radial-gradient(1.4px 1.4px at 75% 25%, #fff8 40%, transparent 42%),
    radial-gradient(1.2px 1.2px at 35% 80%, #fff7 40%, transparent 42%);
  animation: starDriftNear 36s linear infinite;
}
@keyframes starDriftFar { to { transform: translate3d(-2%, -3%, 0); } }
@keyframes starDriftNear{ to { transform: translate3d(-4%, -6%, 0); } }

/* ---------- 背景：流星（容器+單體樣式） ---------- */
#meteor-layer{ position:absolute; inset:0; pointer-events:none; z-index:0; overflow:hidden; }
.meteor{
  position:absolute; width:2px; height:2px; border-radius:50%;
  background:#fff; box-shadow:0 0 8px #9cf, 0 0 16px #9cf6;
  transform: translate3d(0,0,0);
  animation: meteorFly var(--dur,0.9s) ease-out forwards;
}
.meteor::before{
  content:""; position:absolute; right:2px; top:50%; height:2px; width:120px;
  transform: translateY(-50%) rotate(0deg);
  background: linear-gradient(90deg, #9cf8, transparent);
  filter: blur(0.5px);
}
@keyframes meteorFly{
  from { opacity:0; transform: translate3d(var(--sx,60vw), var(--sy,10vh), 0) rotate(-35deg); }
  10%  { opacity:1; }
  to   { opacity:0; transform: translate3d(calc(var(--sx,60vw) - 90vw), calc(var(--sy,10vh) + 60vh), 0) rotate(-35deg); }
}

/* ---------- 背景：底緣砂塵（粒子重複動畫） ---------- */
#dust-layer{ position:absolute; left:0; right:0; bottom:0; height:18vh; pointer-events:none; z-index:1; overflow:hidden; }
.dust{
  position:absolute; bottom:-6px; width:3px; height:3px; border-radius:50%;
  background: #d8c08a; opacity:0.0;
  animation: dustRise var(--t,6s) ease-in infinite;
  filter: drop-shadow(0 0 4px #d8c08a);
}
@keyframes dustRise{
  0%   { transform: translate3d(var(--x,0), 0, 0) scale(.8); opacity:0; }
  10%  { opacity:.35; }
  80%  { opacity:.2; }
  100% { transform: translate3d(calc(var(--x,0) + 40px), -20vh, 0) scale(1.1); opacity:0; }
}

/* ---------- 卡片：翻面金屬掃光（僅正面，觸發一次） ---------- */
.card.shine .card-front::after{
  content:""; position:absolute; inset:-40%;
  background: linear-gradient(115deg, transparent 45%, #ffffff88 49%, #ffffff00 55%, transparent 60%);
  transform: translateX(-120%) rotate(8deg);
  animation: shineSweep 0.9s cubic-bezier(.3,.6,.2,1) forwards;
}
@keyframes shineSweep{ to{ transform: translateX(120%) rotate(8deg) } }

/* ---------- 卡片：中心聚焦微抬、兩側微暗 ---------- */
.card.is-center .card-inner{
  transform: translateZ(6px) rotateX(var(--tiltX,0deg)) rotateY(calc(var(--flip, 0deg) + var(--tiltY,0deg)));
  box-shadow: 0 16px 44px -18px rgba(91,124,255,.24), 0 0 0 1px #8EE7FF26 inset;
}
.card:not(.is-center){ opacity: .96; }

/* ---------- 卡片：翻面改用 CSS 變數（為了疊加 tilt，不改你 JS） ---------- */
.card .card-inner{
  transition: transform .5s cubic-bezier(.2,.6,.2,1);
  transform: rotateX(var(--tiltX,0deg)) rotateY(calc(var(--flip, 0deg) + var(--tiltY,0deg)));
}
.card.flipped .card-inner{ --flip: 180deg; }

/* ---------- 卡片：桌機 hover 微傾斜（僅 is-center） ---------- */
@media (hover: hover) and (pointer: fine){
  .card.is-center:hover .card-inner{
    /* 變化由 JS 寫入 --tiltX / --tiltY；這裡只加一點陰影強度 */
    box-shadow: 0 22px 58px -20px rgba(91,124,255,.34), 0 0 0 1px #8EE7FF33 inset;
  }
}

/* ---------- 文字：標題掃描線（可見度↑） ---------- */
.title{ position:relative; }
.title::after{
  content:""; position:absolute; left:-15%; top:0; height:100%; width:28%;
  background: linear-gradient(120deg, transparent 0%, #FFFFFF55 50%, transparent 100%);
  transform: skewX(-12deg) translateX(-10%); filter: blur(6px);
  animation: titleScan 5.2s ease-in-out infinite;
}
@keyframes titleScan{
  0%,20%{ transform: skewX(-12deg) translateX(-10%) }
  45%   { transform: skewX(-12deg) translateX(140%) }
  100%  { transform: skewX(-12deg) translateX(140%) }
}

/* ---------- 文字：圓環（--p 變化時平滑） ---------- */
.ring-progress{ transition: background .6s ease; }

/* （數字滾動與解碼屬 JS 行為，無需額外 CSS） */
