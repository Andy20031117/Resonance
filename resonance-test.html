<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>共振導向系統 · 復古場景測驗</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #0b0908;
      --fg: #f5ecdd;
      --muted: #b3a38b;
      --accent: #e3c15d;
      --accent-soft: rgba(227,193,93,0.16);
      --card: rgba(13,9,7,0.9);
      --border: #3a3027;
    }
    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Noto Sans TC","Microsoft JhengHei", sans-serif;
      background:
        radial-gradient(120% 160% at 10% 0%, #2a2018 0%, #0b0908 50%, #000 100%);
      color: var(--fg);
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .shell {
      width: 100%;
      max-width: 960px;
      min-height: 520px;
      border-radius: 20px;
      border: 1px solid var(--border);
      box-shadow:
        0 24px 60px rgba(0,0,0,0.85),
        0 0 0 1px rgba(250,250,250,0.03);
      background:
        radial-gradient(140% 200% at 50% 0%, #221813 0%, #120e0c 55%, #070606 100%);
      overflow: hidden;
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 2.2fr);
      position: relative;
    }

    @media (max-width: 840px) {
      body {
        padding: 10px;
      }
      .shell {
        grid-template-columns: 1fr;
        min-height: 0;
      }
    }

    .shell::before {
      content: "";
      position: absolute;
      inset: -40%;
      background-image:
        radial-gradient(circle at 0% 0%, rgba(227,193,93,0.21) 0, transparent 55%),
        radial-gradient(circle at 90% 0, rgba(227,193,93,0.13) 0, transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.7;
      pointer-events: none;
    }

    /* 左邊：場景背景（之後可換成實際照片） */
    .scene-pane {
      position: relative;
      overflow: hidden;
      border-right: 1px solid rgba(255,255,255,0.06);
    }

    @media (max-width: 840px) {
      .scene-pane {
        min-height: 200px;
        border-right: none;
        border-bottom: 1px solid rgba(255,255,255,0.08);
      }
    }

    .scene-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      filter: grayscale(0.4) contrast(1.05);
      opacity: 0.25;
    }

    .scene-overlay {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 10% 0%, rgba(0,0,0,0) 0%, rgba(0,0,0,0.7) 60%),
        radial-gradient(circle at 90% 100%, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.9) 70%);
    }

    .scene-inner {
      position: relative;
      z-index: 1;
      height: 100%;
      padding: 18px 18px 18px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .eyebrow {
      font-size: 0.78rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .scene-title {
      margin-top: 6px;
      font-family: "Noto Serif TC","Times New Roman",serif;
      font-size: 1.2rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--accent);
    }

    .scene-sub {
      margin-top: 6px;
      font-size: 0.88rem;
      color: var(--muted);
      line-height: 1.6;
    }

    .progress-wrap {
      margin-top: auto;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .progress-bar {
      margin-top: 4px;
      height: 4px;
      background: rgba(255,255,255,0.06);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-bar-inner {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--accent), #ffefaa);
      transition: width 0.4s ease;
    }

    /* 右邊：作答卡片 */
    .question-pane {
      position: relative;
      padding: 18px 18px 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 520px;
      background: var(--card);
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 16px 16px 14px;
      box-shadow:
        0 16px 40px rgba(0,0,0,0.75),
        0 0 0 1px rgba(250,250,250,0.03);
      overflow: hidden;
    }

    .card::before {
      content: "Q";
      position: absolute;
      top: 6px;
      right: 10px;
      font-size: 2.8rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.03);
      pointer-events: none;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-step {
      font-size: 0.8rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .card-step strong {
      color: var(--accent);
    }

    .card-hint {
      font-size: 0.76rem;
      color: var(--muted);
    }

    .question-text {
      margin: 2px 0 10px;
      font-size: 0.98rem;
      line-height: 1.6;
    }

    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    @media (max-width: 540px) {
      .options {
        grid-template-columns: 1fr;
      }
    }

    .option-btn {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(15,11,8,0.9);
      padding: 7px 12px;
      font-size: 0.86rem;
      color: var(--fg);
      text-align: left;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .option-btn span.bullet {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: var(--muted);
      flex-shrink: 0;
    }

    .option-btn span.label {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .option-btn::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(227,193,93,0.25), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .option-btn:hover::after {
      opacity: 1;
    }

    .option-btn:hover {
      border-color: rgba(227,193,93,0.9);
    }

    .nav-hint {
      margin-top: 10px;
      font-size: 0.76rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .nav-hint button {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: transparent;
      color: var(--muted);
      font-size: 0.76rem;
      padding: 4px 10px;
      cursor: pointer;
    }

    .fade-in {
      animation: fadeInUp 0.4s ease;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body>
  <main class="shell">
    <!-- 左側：場景區（之後可加照片） -->
    <section class="scene-pane">
      <div class="scene-bg" id="sceneBg"></div>
      <div class="scene-overlay"></div>
      <div class="scene-inner">
        <div>
          <div class="eyebrow">共振導向系統 · Resonance Test</div>
          <h1 class="scene-title" id="sceneTitle">場景</h1>
          <p class="scene-sub" id="sceneDesc">
            你正走進一個復古年代的小場景，請靠直覺選出第一個吸引你的東西。
          </p>
        </div>
        <div class="progress-wrap">
          <div id="progressLabel">問題 1 / 6</div>
          <div class="progress-bar">
            <div class="progress-bar-inner" id="progressBarInner"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- 右側：題目卡片 -->
    <section class="question-pane">
      <div class="card fade-in" id="card">
        <header class="card-header">
          <div class="card-step" id="stepLabel">Q01 · 直覺選擇</div>
          <div class="card-hint">選出你「第一個想靠近」的東西即可。</div>
        </header>
        <div class="question-text" id="questionText">
          你第一個注意到的是？
        </div>
        <div class="options" id="optionsContainer">
          <!-- JS 填入 -->
        </div>
        <div class="nav-hint">
          <span>總共有 6 題，整個過程約 30 秒。</span>
          <button type="button" id="btnRestart">重新開始</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // 六題題庫（之後你可以搬到獨立 data.js）
    const QUESTIONS = [
      {
        id: 1,
        scene: "老房子的客廳",
        desc: "你打開木門走進客廳，陽光從花窗撒進來。你第一個注意到的是？",
        img: "img/scene-livingroom.jpg", // 之後放實際圖
        options: [
          { text: "老電扇的暖風", type: "temp" },
          { text: "掛鐘的滴答聲", type: "freq" },
          { text: "電視白噪點", type: "sig" },
          { text: "泛黃的記事本", type: "mem" },
          { text: "收音機雜訊", type: "noise" },
          { text: "錄音機錄音鍵", type: "echo" }
        ]
      },
      {
        id: 2,
        scene: "老式廚房",
        desc: "鍋蓋輕敲、蒸氣上升，你走進廚房。你身體最先被吸引的是？",
        img: "img/scene-kitchen.jpg",
        options: [
          { text: "熱湯蒸氣", type: "temp" },
          { text: "切菜節奏", type: "freq" },
          { text: "爐火亮起", type: "sig" },
          { text: "貼滿的食譜", type: "mem" },
          { text: "金屬鍋氣味", type: "noise" },
          { text: "油亮食物", type: "echo" }
        ]
      },
      {
        id: 3,
        scene: "街口",
        desc: "你來到巷口，小販聲與車聲交錯。下一秒你注意到的是？",
        img: "img/scene-street.jpg",
        options: [
          { text: "陽光味", type: "temp" },
          { text: "機車聲", type: "freq" },
          { text: "奇怪小物件", type: "sig" },
          { text: "公告牆", type: "mem" },
          { text: "怪怪的招牌", type: "noise" },
          { text: "追逐笑聲", type: "echo" }
        ]
      },
      {
        id: 4,
        scene: "文具行",
        desc: "鐵門半開的文具行，空氣裡是紙香與塑膠味。你第一個走向哪裡？",
        img: "img/scene-stationery.jpg",
        options: [
          { text: "暖色蠟筆", type: "temp" },
          { text: "整齊鉛筆", type: "freq" },
          { text: "新奇筆", type: "sig" },
          { text: "分類紙張", type: "mem" },
          { text: "卡鍵計算機", type: "noise" },
          { text: "貼紙牆", type: "echo" }
        ]
      },
      {
        id: 5,
        scene: "舊書房",
        desc: "書房裡充滿木頭與舊紙味。你最先靠近的是？",
        img: "img/scene-study.jpg",
        options: [
          { text: "相簿信件", type: "temp" },
          { text: "筆筒與時鐘", type: "freq" },
          { text: "奇怪封面", type: "sig" },
          { text: "分類資料", type: "mem" },
          { text: "粗糙邊緣書本", type: "noise" },
          { text: "插圖雜誌", type: "echo" }
        ]
      },
      {
        id: 6,
        scene: "夜晚屋頂",
        desc: "夜風帶著城市聲，你站在屋頂。抬頭時，你最先感受到？",
        img: "img/scene-rooftop.jpg",
        options: [
          { text: "風的溫度", type: "temp" },
          { text: "遠方燈號", type: "freq" },
          { text: "亮光劃過", type: "sig" },
          { text: "心裡的線索", type: "mem" },
          { text: "怪異燈光", type: "noise" },
          { text: "城市回聲", type: "echo" }
        ]
      }
    ];

    const ORDER = ["temp", "freq", "sig", "mem", "noise", "echo"];

    let currentIndex = 0;
    let scores = {
      temp: 0,
      freq: 0,
      sig: 0,
      mem: 0,
      noise: 0,
      echo: 0
    };

    const sceneBgEl = document.getElementById("sceneBg");
    const sceneTitleEl = document.getElementById("sceneTitle");
    const sceneDescEl = document.getElementById("sceneDesc");
    const progressLabelEl = document.getElementById("progressLabel");
    const progressBarInnerEl = document.getElementById("progressBarInner");

    const cardEl = document.getElementById("card");
    const stepLabelEl = document.getElementById("stepLabel");
    const questionTextEl = document.getElementById("questionText");
    const optionsContainerEl = document.getElementById("optionsContainer");
    const btnRestart = document.getElementById("btnRestart");

    function renderQuestion() {
      const q = QUESTIONS[currentIndex];
      const total = QUESTIONS.length;
      const step = currentIndex + 1;

      // 場景文字
      sceneTitleEl.textContent = q.scene;
      sceneDescEl.textContent = q.desc || "請依直覺選擇。";

      // 背景圖（未來你放真圖就會套用）
      sceneBgEl.style.backgroundImage = q.img ? `url('${q.img}')` : "none";

      // 進度
      progressLabelEl.textContent = `問題 ${step} / ${total}`;
      const percent = (step / total) * 100;
      progressBarInnerEl.style.width = `${percent}%`;

      // 卡片標頭
      stepLabelEl.textContent = `Q${String(step).padStart(2, "0")} · 直覺選擇`;

      // 題目文字（保留一個簡短句子）
      questionTextEl.textContent = "選出你第一個想靠近的東西。";

      // 選項
      optionsContainerEl.innerHTML = "";
      q.options.forEach((opt, idx) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "option-btn";
        btn.innerHTML = `
          <span class="bullet">${String.fromCharCode(65 + idx)}</span>
          <span class="label">${opt.text}</span>
        `;
        btn.addEventListener("click", () => handleChoice(opt.type));
        optionsContainerEl.appendChild(btn);
      });

      // 動畫 reset
      cardEl.classList.remove("fade-in");
      void cardEl.offsetWidth; // reflow
      cardEl.classList.add("fade-in");
    }

    function handleChoice(type) {
      if (!type || !scores.hasOwnProperty(type)) return;
      scores[type] += 1;

      if (currentIndex < QUESTIONS.length - 1) {
        currentIndex += 1;
        renderQuestion();
      } else {
        // 全部答完 → 計算結果
        const resultType = getResultType();
        // 導到結果頁（你之前那個 resonance-result.html）
        window.location.href = `resonance-result.html?type=${encodeURIComponent(resultType)}`;
      }
    }

    function getResultType() {
      let max = -Infinity;
      let bestTypes = [];
      for (const key of ORDER) {
        const val = scores[key];
        if (val > max) {
          max = val;
          bestTypes = [key];
        } else if (val === max) {
          bestTypes.push(key);
        }
      }
      // 有平手就依 ORDER 順序選第一個
      if (bestTypes.length === 0) return "temp";
      for (const k of ORDER) {
        if (bestTypes.includes(k)) return k;
      }
      return bestTypes[0];
    }

    function resetTest() {
      currentIndex = 0;
      scores = { temp:0, freq:0, sig:0, mem:0, noise:0, echo:0 };
      renderQuestion();
    }

    btnRestart.addEventListener("click", resetTest);

    // 初始化
    renderQuestion();
  </script>
</body>
</html>
