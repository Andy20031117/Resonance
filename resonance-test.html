<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>共振導向系統 · 復古場景測驗</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #0b0908;
      --fg: #f5ecdd;
      --muted: #b3a38b;
      --accent: #e3c15d;
      --card: rgba(13,9,7,0.96);
      --border: #3a3027;
    }
    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Noto Sans TC","Microsoft JhengHei", sans-serif;
      background:
        radial-gradient(120% 160% at 10% 0%, #2a2018 0%, #0b0908 50%, #000 100%);
      color: var(--fg);
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .shell {
      width: 100%;
      max-width: 1040px;
      min-height: 520px;
      border-radius: 20px;
      border: 1px solid var(--border);
      box-shadow:
        0 24px 60px rgba(0,0,0,0.85),
        0 0 0 1px rgba(250,250,250,0.03);
      background:
        radial-gradient(140% 200% at 50% 0%, #221813 0%, #120e0c 55%, #070606 100%);
      overflow: hidden;
      display: grid;
      grid-template-columns: minmax(0, 1.5fr) minmax(0, 2.5fr);
      position: relative;
    }

    @media (max-width: 840px) {
      body { padding: 10px; }
      .shell {
        grid-template-columns: 1fr;
        min-height: 0;
      }
    }

    .shell::before {
      content: "";
      position: absolute;
      inset: -40%;
      background-image:
        radial-gradient(circle at 0% 0%, rgba(227,193,93,0.21) 0, transparent 55%),
        radial-gradient(circle at 90% 0, rgba(227,193,93,0.13) 0, transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.7;
      pointer-events: none;
    }

    .scene-pane {
      position: relative;
      overflow: hidden;
      border-right: 1px solid rgba(255,255,255,0.06);
    }

    @media (max-width: 840px) {
      .scene-pane {
        min-height: 180px;
        border-right: none;
        border-bottom: 1px solid rgba(255,255,255,0.08);
      }
    }

    .scene-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      filter: grayscale(0.4) contrast(1.05);
      opacity: 0.18;
    }

    .scene-overlay {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 10% 0%, rgba(0,0,0,0) 0%, rgba(0,0,0,0.7) 60%),
        radial-gradient(circle at 90% 100%, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.9) 70%);
    }

    .scene-inner {
      position: relative;
      z-index: 1;
      height: 100%;
      padding: 20px 20px 14px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .eyebrow {
      font-size: 0.82rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .scene-title {
      margin-top: 8px;
      font-family: "Noto Serif TC","Times New Roman",serif;
      font-size: 1.6rem;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: var(--accent);
      text-indent: 0.28em;
    }

    .scene-sub {
      margin-top: 10px;
      font-size: 0.94rem;
      color: var(--muted);
      line-height: 1.7;
    }

    .progress-wrap {
      margin-top: auto;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .progress-bar {
      margin-top: 4px;
      height: 4px;
      background: rgba(255,255,255,0.06);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-bar-inner {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--accent), #ffefaa);
      transition: width 0.4s ease;
    }

    .question-pane {
      position: relative;
      padding: 18px 18px 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 620px;
      background: var(--card);
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 18px 18px 14px;
      box-shadow:
        0 16px 40px rgba(0,0,0,0.75),
        0 0 0 1px rgba(250,250,250,0.03);
      overflow: hidden;
    }

    .card::before {
      content: "Q";
      position: absolute;
      top: 6px;
      right: 10px;
      font-size: 2.8rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.03);
      pointer-events: none;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 10px;
    }

    .card-step {
      font-size: 0.8rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .card-step strong {
      color: var(--accent);
    }

    .card-hint {
      font-size: 0.76rem;
      color: var(--muted);
      text-align: right;
    }

    .question-title {
      margin: 0 0 4px;
      font-size: 1.05rem;
      font-weight: 600;
    }

    .question-text {
      margin: 0 0 12px;
      font-size: 0.96rem;
      line-height: 1.7;
      color: var(--fg);
    }

    .options {
      display: grid;
      grid-template-columns: 1fr; /* 改成單欄直向 */
      gap: 8px;
    }

    .option-btn {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(15,11,8,0.95);
      padding: 7px 12px;
      font-size: 0.9rem;
      color: var(--fg);
      text-align: left;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .option-btn span.bullet {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.72rem;
      color: var(--muted);
      flex-shrink: 0;
    }

    .option-btn span.label {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .option-btn::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(227,193,93,0.25), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .option-btn:hover::after {
      opacity: 1;
    }

    .option-btn:hover {
      border-color: rgba(227,193,93,0.9);
    }

    .nav-hint {
      margin-top: 12px;
      font-size: 0.78rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .nav-hint button,
    .nav-hint a {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(10,7,6,0.92);
      color: var(--muted);
      font-size: 0.76rem;
      padding: 4px 10px;
      cursor: pointer;
      text-decoration: none;
      white-space: nowrap;
    }

    .nav-hint button:hover,
    .nav-hint a:hover {
      border-color: rgba(227,193,93,0.6);
      color: var(--accent);
    }

    .fade-in {
      animation: fadeInUp 0.4s ease;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <main class="shell">
    <!-- 左側：場景區 -->
    <section class="scene-pane">
      <div class="scene-bg" id="sceneBg"></div>
      <div class="scene-overlay"></div>
      <div class="scene-inner">
        <div>
          <div class="eyebrow">共振導向系統 · RESONANCE TEST</div>
          <h1 class="scene-title" id="sceneTitle">晨光</h1>
          <p class="scene-sub" id="sceneDesc">
            你正身處老台灣的「晨光」，請依直覺作答。
          </p>
        </div>
        <div class="progress-wrap">
          <div id="progressLabel">問題 1 / 6</div>
          <div class="progress-bar">
            <div class="progress-bar-inner" id="progressBarInner"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- 右側：題目卡片 -->
    <section class="question-pane">
      <div class="card fade-in" id="card">
        <header class="card-header">
          <div class="card-step" id="stepLabel">Q01 · 直覺選擇</div>
          <div class="card-hint">不要想太多，只選「第一個浮現的畫面」。</div>
        </header>
        <div class="question-title" id="questionTitle">晨光</div>
        <div class="question-text" id="questionText">
          你剛醒來時，第一個闖入耳裡的，是——？
        </div>
        <div class="options" id="optionsContainer">
          <!-- JS 填入 -->
        </div>
        <div class="nav-hint">
          <span>共 6 題，完成後會為你生成一則共振人格側寫。</span>
          <div>
            <a href="resonance-start.html">回到測驗介紹</a>
            <a href="resonance-archive.html">查看人格手冊</a>
            <button type="button" id="btnRestart">重新開始</button>
            <a href="index.html">展覽首頁</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    const QUESTIONS = [
      {
        id: 1,
        key: "morning",
        sceneTitle: "晨光",
        img: "",
        prompt: "你剛醒來時，第一個闖入耳裡的，是——？",
        options: [
          { text: "微暖的晨風吹", type: "temp" },
          { text: "腳踏車輕輕叮噹", type: "freq" },
          { text: "巷口熟悉叫賣聲", type: "sig" },
          { text: "老電視低低的說話", type: "mem" },
          { text: "電風扇輕微抖動聲", type: "noise" },
          { text: "孩子們的清亮笑聲", type: "echo" }
        ]
      },
      {
        id: 2,
        key: "kitchen",
        sceneTitle: "炊氣",
        img: "",
        prompt: "走進老廚房，最先撲鼻而來的，是——？",
        options: [
          { text: "熱湯升起的暖蒸氣", type: "temp" },
          { text: "木櫥散出的淡淡木香", type: "freq" },
          { text: "爐火突然的微焦味", type: "sig" },
          { text: "食譜紙張的乾書味", type: "mem" },
          { text: "鐵鍋受熱的金屬味", type: "noise" },
          { text: "剛煎點心的油香氣", type: "echo" }
        ]
      },
      {
        id: 3,
        key: "alley",
        sceneTitle: "巷隅",
        img: "",
        prompt: "踏出家門，你的第一眼落在——？",
        options: [
          { text: "陽光照在晒衣的亮影", type: "temp" },
          { text: "路口紅綠燈的閃爍節奏", type: "freq" },
          { text: "路邊一件奇怪的小玩意", type: "sig" },
          { text: "佈告欄上密密的字紙", type: "mem" },
          { text: "招牌突然不規律地閃光", type: "noise" },
          { text: "巷底學生邊走邊笑鬧", type: "echo" }
        ]
      },
      {
        id: 4,
        key: "desk",
        sceneTitle: "墨印",
        img: "",
        prompt: "路過書桌，你最想伸手碰——？",
        options: [
          { text: "曬得暖暖的桌巾布料", type: "temp" },
          { text: "木筆筒圓滑的邊角", type: "freq" },
          { text: "一支亮得很突兀的新筆", type: "sig" },
          { text: "貼著標籤的舊資料夾", type: "mem" },
          { text: "書本邊緣粗粗的磨損感", type: "noise" },
          { text: "雜誌封面上的彩色插圖", type: "echo" }
        ]
      },
      {
        id: 5,
        key: "evening",
        sceneTitle: "暮聲",
        img: "",
        prompt: "傍晚裡，你停下腳步，只因為聽見——？",
        options: [
          { text: "鄰居收衣的輕輕拍動", type: "temp" },
          { text: "公車靠近的固定節奏", type: "freq" },
          { text: "哪裡突然傳來的一聲響", type: "sig" },
          { text: "店家收攤時的紙箱沙沙", type: "mem" },
          { text: "老喇叭播放的卡卡雜音", type: "noise" },
          { text: "巷口越聚越熱的談笑聲", type: "echo" }
        ]
      },
      {
        id: 6,
        key: "night",
        sceneTitle: "夜影",
        img: "",
        prompt: "夜裡的街上，你最先跟隨——？",
        options: [
          { text: "街燈微暖的橘黃色光", type: "temp" },
          { text: "遠方電塔規律的閃燈", type: "freq" },
          { text: "天邊突然劃過的小亮點", type: "sig" },
          { text: "你筆記本裡那條熟悉線索", type: "mem" },
          { text: "大樓窗戶忽明忽暗的怪光", type: "noise" },
          { text: "晚風帶來的城市回聲", type: "echo" }
        ]
      }
    ];

    const ORDER = ["temp", "freq", "sig", "mem", "noise", "echo"];

    let currentIndex = 0;
    let scores = { temp:0, freq:0, sig:0, mem:0, noise:0, echo:0 };

    const sceneBgEl = document.getElementById("sceneBg");
    const sceneTitleEl = document.getElementById("sceneTitle");
    const sceneDescEl = document.getElementById("sceneDesc");
    const progressLabelEl = document.getElementById("progressLabel");
    const progressBarInnerEl = document.getElementById("progressBarInner");

    const cardEl = document.getElementById("card");
    const stepLabelEl = document.getElementById("stepLabel");
    const questionTitleEl = document.getElementById("questionTitle");
    const questionTextEl = document.getElementById("questionText");
    const optionsContainerEl = document.getElementById("optionsContainer");
    const btnRestart = document.getElementById("btnRestart");

    function renderQuestion() {
      const q = QUESTIONS[currentIndex];
      const total = QUESTIONS.length;
      const step = currentIndex + 1;

      sceneTitleEl.textContent = q.sceneTitle;
      sceneDescEl.textContent =
        "你正身處老台灣的「" + q.sceneTitle + "」，請依直覺作答。";

      sceneBgEl.style.backgroundImage = q.img ? `url('${q.img}')` : "none";

      progressLabelEl.textContent = `問題 ${step} / ${total}`;
      progressBarInnerEl.style.width = `${(step/total)*100}%`;

      stepLabelEl.textContent = `Q${String(step).padStart(2,"0")} · 直覺選擇`;
      questionTitleEl.textContent = q.sceneTitle;
      questionTextEl.textContent = q.prompt;

      optionsContainerEl.innerHTML = "";
      q.options.forEach((opt, idx) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "option-btn";
        btn.innerHTML = `
          <span class="bullet">${String.fromCharCode(65 + idx)}</span>
          <span class="label">${opt.text}</span>
        `;
        btn.addEventListener("click", () => handleChoice(opt.type));
        optionsContainerEl.appendChild(btn);
      });

      cardEl.classList.remove("fade-in");
      void cardEl.offsetWidth;
      cardEl.classList.add("fade-in");
    }

    function handleChoice(type) {
      if (!type || !scores.hasOwnProperty(type)) return;
      scores[type] += 1;

      if (currentIndex < QUESTIONS.length - 1) {
        currentIndex += 1;
        renderQuestion();
      } else {
        const resultType = getResultType();
        window.location.href =
          `resonance-result.html?type=${encodeURIComponent(resultType)}`;
      }
    }

    function getResultType() {
      let max = -Infinity;
      let best = [];
      for (const key of ORDER) {
        const val = scores[key];
        if (val > max) {
          max = val;
          best = [key];
        } else if (val === max) {
          best.push(key);
        }
      }
      if (best.length === 0) return "temp";
      for (const k of ORDER) if (best.includes(k)) return k;
      return best[0];
    }

    function resetTest() {
      currentIndex = 0;
      scores = { temp:0, freq:0, sig:0, mem:0, noise:0, echo:0 };
      renderQuestion();
    }

    btnRestart.addEventListener("click", resetTest);

    renderQuestion();
  </script>
</body>
</html>
